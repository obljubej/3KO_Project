## Functionality and Circuitry Explanation

# Pacemaker Microcontroller Shield

### Guy Meyer

### meyerg@mcmaster.ca

### 1320231

### November 2, 2020

## Contents

- 1 Introduction
  - 1.1 Product Overview
  - 1.2 Pacemaker Overview
  - 1.3 Purpose
  - 1.4 Interfaces
    - 1.4.1 Bioelectrical Interface
    - 1.4.2 Microcontroller Interface
- 2 Pin Explanation
  - 2.1 Pin Layout
- 3 Circuitry Flowchart and Details
  - 3.1 AV Sensing Circuit Flowchart
  - 3.2 AV Pacing Circuit Flowchart
  - 3.3 Mandatory Pin Arrangements for Pacing
    - 3.3.1 Charging C22
    - 3.3.2 AV Pacing
    - 3.3.3 Discharging Blocking Capacitor (may be combined with state 1)
    - 3.3.4 PWM
  - 3.4 Strength-Duration Curve
  - 3.5 Proper Pace Capture
  - 3.6 Desired Waveform
- 4 Pacemaker Impedance
  - 4.1 What is Impedance?
  - 4.2 Resistance in Pacemaker
    - 4.2.1 Electrodes Conductivity
    - 4.2.2 Membrane Conductivity
  - 4.3 Capacitance in Pacemakers
    - 4.3.1 Membrane Capacitance
    - 4.3.2 Net Zero Charge
    - 4.3.3 Potential Risk of Charge Build-up
  - 4.4 DCM to Pacemaker Communication via Inductance
- 5 Hysteresis Pacing
  - 5.1 What is Hysteresis Pacing
  - 5.2 Example of Implementation
  - 1 Mapping between Techincal and Corresponding Pin Names specific for K64F microcontroller List of Tables
  - 2 Implications and Causes of Undesired Electrode Impedances

## 1 Introduction

### 1.1 Product Overview

The Pacemaker shield is designed to simulate the bioelectrical interface between the heart and a real-time microcontroller.

### 1.2 Pacemaker Overview

A pacemaker is responsible for monitoring the operation of the heart while providing quick electrical pulses at specific time
instances (pulses). Each electrical pulse forces the heart to contract and perform its natural function. When observed on
the surface of the human body (ie. a cardiograph) the total electrical signal is known as the PQRST Waveform. Note
that a single electrical pulse can trigger the entire waveform. If the heart is pacing correctly without electrical assistance
the pacemaker must then continue monitoring its activity until a malfunction is detected. Otherwise, the pacemaker will
continually pace the heart to maintain proper functionality.

For this application, a two-lead connection is utilized; one to the ventricle (lower chamber of the heart), and one to the
atrium (higher chamber of the heart). These leads apply pulses at offset time instances to allow blood to flow throughout
the heart and into the body. While sensing heart signals, data is collected through the same bipolar electrodes. The data
from each chamber (atrium or ventricle) provides analog signals indicative of its electrical activity. This signal can be
compared with a baseline voltage to detect a natural pulse. An electrode is found in each chamber and is responsible for
both the sensing and the pacing.

### 1.3 Purpose

The purpose of the shield (attached to the top of the microcontroller) is to allow for the microcontroller to send and
receive pacing information, as well as collect data signals to and from the heart through the dual lead connections. The
shield accepts PWM input used to charge capacitors that determine voltage settings in various locations of the shield (ie.
pulse voltage, comparator voltage, ...). In the case of an artificial pace (generated by the pacemaker) the shield utilizes
the PWM input from the board to achieve the programmed pacing voltage. But if a natural pace preceeds it then the
shield will detect the natural pace with the use of a comparator circuit and tuned PWM duty cycles.

PWM is explained inSection 3.3.

### 1.4 Interfaces

This section will list and describe the various interfaces that occur in this system.

#### 1.4.1 Bioelectrical Interface

The leads that enter the heart are standard ring-tip electrodes that attach to the atrial and ventricular chambers.

```
Figure 1: Ring-to-Tip Electrodes Used to Connect to the Heart
```

By applying a voltage potential between the ring (+ve) and tip (-ve) of the electrode then sufficient current will cause the
heart to contract and perform the proper pacing functionality. When monitoring the heart internally and observing the
action potential (natural signal) produced by both the atrium and the ventricle, it looks approximately as follows:

```
Figure 2: Intracadiac Electrogram Signals produced by the heart internally [ref]
```

It is a common mistake to think that an ECG is the signal that is collected by the pacemaker. Since the pacemaker is
internal then it must collect internal signals. Intracardiac Electrograms (EGM) is the name of the signal that is produced
by both the atrial and the ventricle separately.

#### 1.4.2 Microcontroller Interface

The shield is designed to have the same pin layout as the FRDM K64F board. The microcontroller uses the circuitry in
the board to apply the proper actions onto the heart. A detailed explanation of all pins is presented in this document.

## 2 Pin Explanation

### 2.1 Pin Layout

The pin descriptions follow the pin layout of the FRDM K64F microcontroller. The shield physically fits in most Arduinos
and STM32 boards but isnotpin-to-pin compatible with these controllers. Most notably due to the lack of PWM pins,
specifically in the D2 and D4 locations.

Table 1: Mapping between Techincal and Corresponding Pin Names specific for K64F microcontroller

```
Pin Name Corresponding Name Functionality
D0 ATRCMPDETECT Used in the sensing circuitry of the atrium. Outputs ON (HIGH)
when signal voltage is higher than threshold voltage and OFF
(LOW) otherwise (includes 5mV hysteresis).
```

```
D1 VENTCMPDETECT Same functionality as in ATRCMPDETECT but for the ventri-
cle sensing signal (includes 5mV hysteresis).
D2 PACECHARGECTRL Used to start and stop the charging of the primary capacitor
(C22).
```

```
If ON (HIGH)→PWM charges C
If OFF (LOW)→PWM disconnected from circuit
```

```
NEVER allow this signal to be set to HIGH if either
ATRPACECTRL and/or VENTPACECTRL are HIGH
because then the patient may be directly connected to the PWM
signal!
```

```
D3 VENTCMPREFPWM In order to establish a threshold for when the ventricular action
potential should be sensed, this pin uses PWM to charge a
capacitor that will sustain a constant voltage for comparison.
```

```
Note that the capacitor voltage is linearly proportional to
the Duty Cycle of the PWM input. Use default PWM frequency.
D4 ZATRCTRL This control allows the impedance circuit to be connected to the
ring electrode of the atrium. It is used to analyze the impedance
of the atrial electrode and the electrical connection between the
atrial electrodes and the atrium itself. The output of this circuit
is found at the ZSIGNAL pin.
```

```
More information regarding lead impedances is mentioned
in Section 4 of this document.
D5 PACINGREFPWM Used to charge the primary capacitor (C22) of the pacing circuit.
The PWM voltage output by this pin saturates to 0-5V and will
charge C22 is PACECHARGECTRL is HIGH.
```

```
Note that the capacitor voltage is linearly proportional to
the Duty Cycle of the PWM input. Use default PWM frequency.
```

```
D6 ATRCMPREFPWM Same functionality as in VENTCMPREFPWM but for the
atrial action potential.
```

```
Note that the capacitor voltage is linearly proportional to
the Duty Cycle of the PWM input. Use default PWM frequency.
```

```
D7 ZVENTCTRL This control allows the impedance circuit to be connected
to the ring electrode of the ventricle. Its use is identical to
ZATRCTRL but for the ventricle.
```

```
More information regarding lead impedances is mentioned
in Section 4 of this document.
```

```
D8 ATRPACECTRL Used to discharge the primary capacitor through the atrium.
Current flows through the switch if set to HIGH. If LOW there is
no current flow. Pay attention to the direction at which current
flows through the electrode.
```

```
NEVER allow this output signal to be set to HIGH if
PACECHARGECTRL is HIGH because then the patient’s
atrium may be directly connected to the PWM signal!
```

```
D9 VENTPACECTRL Same functionality as in ATRPACECTRL but for the ventricle.
```

```
NEVER allow this output signal to be set to HIGH if
PACECHARGECTRL is HIGH because then the patient’s
ventricle may be directly connected to the PWM signal!
D10 PACEGNDCTRL To allow current to flow from the ring to the tip in either the
atrium or the ventricle this pin must be HIGH since it controls
the switch directly following the tip.
```

```
Note:Once this pin is activated along with either ...PACECTRL
pins, the charge will flow through the switch and accumulate in
the blocking capacitor (C21).
D11 ATRGNDCTRL Used to connect the ATRRINGOUT to GND. This functional-
ity is used when discharging the blocking capacitor through the
atrium to allow no charge buildup.
D12 VENTGNDCTRL Same functionality as in ATRRINGOUT but for the ventricle.
```

```
D13 FRONTENDCTRL Used to activate the sensing circuitry.
```

```
If ON (HIGH)→Sensing circuitry will output heart signal.
If OFF (LOW)→Sensing circuitry is disconnected from patient
(Green Connectors) and will output nothing.
```

```
Note: This switch controls both the atrial and ventrical
circuits. It is up to the programmer to only record the data they
desire since both will be activated.
```

GND GND References electronic GND. It is good practice to test that all
grounds are connected with low resistance prior to the initial
startup of the device. Once the device is in use or in the body
this process is no longer necessary.

```
AREF - - Disconnected by design -
SDA - - Disconnected by design -
SCL - - Disconnected by design -
```

```
A5/SCL - - Disconnected by design -
A4/SDA VENTRECTSIGNAL This pin connects to the sensing circuitry and is used to output
the rectified analog waveform of the ventricle. This waveform
is used in the comparator amplifier to detect ventiruclar action
potentials.
A3 ATRRECTSIGNAL Same output functionality as in VENTRECTSIGNAL but for
the atrium.
A2 ZSIGNAL Used to analyze the impedance of either the atrium or the
ventricle if necessary.
```

```
More information regarding lead impedances is mentioned
in Section 4 of this document.
A1 VENTSIGNAL This pin outputs the analog waveform of the ventricle prior to full-
wave rectification. This signal best represents what is actually
happening in the heart in real-time. Use this analog output as
data for any electrocardiogram outputs.
```

```
A0 ATRSIGNAL Same functionality as in VENTSIGNAL but for the atrium.
VIN - - Disconnected by design -
GND1 GND Same functionality as GND mentioned above.
```

```
GND2 GND Same functionality as GND mentioned above.
5V 5V Connected to the Arduino 5V output. Used to power the electron-
ics of the shield. It is good practice to test that this is roughly 5V
prior to usage.
3V3 3V3 Arduino uses 3.3V to output an HIGH voltage from the Arduino
pins. It is good practice to test that this is roughly 3.3V prior to
usage.
/RESET - - Disconnected by design -
```

```
IOREF - - Disconnected by design -
```

RESERVED - - Disconnected by design -

## 3 Circuitry Flowchart and Details

### 3.1 AV Sensing Circuit Flowchart

```
Figure 3: Sensing Flowchart Overview
```

1. BAT54S Schottky diode pair used to protect from over or under voltage
   →if voltage is too high relative to GND (other electrode lead)⇒diode ON⇒will drain to 3.3 or GND.
2. HP4066 Analog Switch used to allow electrical flow upon activation
   →if, C⇒ON (HIGH)→flow⇒ON
   C⇒OFF (LOW)→flow⇒OFF (pull high to 3.3V)
3. Voltage attenuation through switch and voltage division over resistor pair.
   →If, x1 attenuation⇒short between input and output.
   x100 attenuation⇒switch through resistor setup (shown below).

```
Figure 4: x1/x100 Attenuation Switch Circuitry
```

4. AD 623 Instrumentational Amplifier with Gain = 10 and CMRR @ 60 Hz of typically 100 dB.

```
100 dB= 20 log 10
```

```
Adifferential
|Acommonmode|
Acommonmode= 10−^4
Note: 60 Hz is attenuated by roughly four orders of magnitude less than signal! Also the output signal is very clean
and DC offset is filtered out.
```

5. RC Passive High Pass Filter

```
Capacitor = 10μF
Resistor = 330 KΩ
```

```
Resulting in Cutoff Freq≈0.05Hz (used to filter out DC w.r.t VGND)
```

```
Figure 5: Circuit Diagram of Passive High Pass Filter
```

6. 2nd Order Band-Pass Filter

```
Input 2nd Order HPF 2nd Order LPF Output
```

```
Figure 6: Sensing Circuit Band-Pass Filter Breakdown
```

```
Note: Standard HPF and LPF circuitry used to design the BPF (Op Amp with 2 caps and 2 resistors)
Bandwidth ranges:
Ventricle sensing circuit→0.1 to 40 Hz
Atrium sensing circuit→0.1 to 70 Hz
```

7. Full-Wave Rectification is achieved by using x2 LMV344 Op Amps along with Schottky diodes to maintain rectified
   direction (+ve).
   →For more look up “precision full-wave rectifier”
   TODO: recitification occurs using VGND which improperly rectifies signals→check how to change this in circuit
8. MCP6546 Comparator used to compare between rectified signal and PWM threshold input.
   →If, threshold>signal⇒Output LOW
   threshold<signal⇒Output HIGH
   9.μController outputs PWM signal with duty cycle thats proportional to the threshold levels with linear proportionality
   →Duty cycle = 0%⇒0 Vref
   100%⇒3.3 Vref
9. Once the comparator triggers to the ON/OFF levels it will output a rising or falling edge to theμC through the
   ATRCMPDETECT pin
   →use this signal to analyze when either the ventricle or atrium trigger a pulse

### 3.2 AV Pacing Circuit Flowchart

```
Figure 7: Pacing Flowchart Overview
```

Note:The ellipses (...) prefacing some of the pins in Figure 7 indicate the EXCLUSIVE replacement ofVENTorATR.

1. PACINGREFPWM is a PWM output from theμC with ranges of 0 to 3.3 V. Its purpose is to charge the capacitor
   based on the duty cycle. For more info reference the Pin Assignment Table above
   →The duty cycle of the PWM signal is linearly proportional to the maintained capacitor voltage.
2. Since only 3.3 V can be output from theμC then a step-up converter is used to set the charged voltage up to 5V.
   →Input PWM from 0-3.3V
   →Output PWM from 0-5V

```
Note: The conversion does not distort the PWM waveform, it simply amplifies it.
```

3. LPF used to diminish high frequency noise, instrumentation noise and 60 Hz

```
fc≈ 48. 2 Hz
```

4. Controlled by PACECHARGECTRL
   →If, CLOSED⇒C22 Charges
   →If, OPEN⇒No Current Flow
5. C22 - Electrolytic Capacitor charged by PWM input signal. As mentioned above, charged voltage is linearly pro-
   portional to the duty cycle of the PWM signal. Higher/Lower frequencies will also alter the charging characteristics
   of the capacitor.
6. To discharge C22, certain switches may be opened to direct current to the Atrium or the Ventricle.

```
ATRPACECTRL VENTPACECTRL Result
```

```
OFF OFF No Pacing
ON OFF Atrial Pacing
OFF ON Ventricular Pacing
ON ON Parallel Connection (Not Useful)
```

```
Note:If PACECHARGECTRL is ON while ...PACECTRL signals are on then the patient will be pulsed with
PWM signal (avoid this due to high voltage and high frequency directly to the patient).
```

7. In order to ground other components of the heart to disallow unwanted pacing (pacing ventricle and atrium is
   floating may cause current flow) the ...GNDCTRL must be activated as a pull-down for the electrode.
8. ...RINGOUT is connected to the ring on the electrode positioned on the heart
9. ...TIPOUT connects to the heart through the electrode and is responsible for the return path of the circuit.
10. This switch is controlled by PACEGNDCTRL and will ground both the ventricular and atrial electrode tips when
    set to ON (closed position).
11. Blocking Capacitor (C21) will receive the charge flow from C22 while pacing occurs. After the initial pacing occurs
    it is necessary to discharge the blocking capacitor back through the heart to produce a net zero current flow in the
    heart (Section 4.3.2). Pacing pulses must be AC with no DC component to discourage long-term electromigration
    effects in the leads and the cells of the heart.

An oversimplified explanation of the discharging sequence can be represented by this image:

```
Figure 8: Simplified Pacing Schematic
```

```
Quick Explanation: Switch S1 is controlled by PACECHARGECTRL. Switch S2, being tri-state, takes
on the capabilities of both ...PACECTRL and ...GNDCTRL, allowing connection
to each path individually. The Pacing Cap is responsible for actual pacing while the
Blocking Cap will slowly discharge over the heart to produce a net zero current flow
(Section 4.3.2).
```

### 3.3 Mandatory Pin Arrangements for Pacing

This section will describe the mandatory pin settings in order to successfully pace. These are set as such in order to avoid
critical errors that may occur otherwise (i.e. unwanted pacing, risking patient, false charging...).

The pacing process is composed of three major cyclic states:

1. Charging primary capacitor (C22)
2. Pacing either Atrium or Ventricle
3. Discharging blocking capacitor (C21)

Note:Steps 1 and 3 can (and should) be done at the same time since they are not electrically dependent.

```
Charging C
and Discharging
Blocking Cap
```

```
Discharging
C22 into AV
(charge C21)
```

```
Pace Ready
```

```
Recharge
Ready
```

```
Figure 9: Dual State Pacing Flowchart
```

3.3.1 Charging C

In order to charge C22 a threshold must be set that is proportional to PWM duty cycle. The PWM signal ranges from 0
to 3.3 V but the converter (mentioned in section 3.2) ranges the signal from 0 to 5 V.

Mandatory Pin Arrangement:

```
Note: Listed in proper chronological order. The order at which the pins are set is crucial for the safety of the
patient (always protect the patient from being directly connected to the PWM input charging signal).
```

```
Pin Setting
```

```
ATRPACECTRL LOW
VENTPACECTRL LOW
PACINGREFPWM 2000 Hz with Desired Duty Cycle
PACECHARGECTRL HIGH
```

#### 3.3.2 AV Pacing

Once the Pacing Capacitor (C22) is charged, the system may require that a pace be applied to either in the atrium or the
ventricle.

Mandatory Pin Arrangement:

```
Note: Listed in proper chronological order. The order at which the pins are set is crucial for the safety of
the patient (always protect the patient from being directly connected to the PWM input charging signal).
```

```
This pin arrangement is an example of pacing the ventricle. For atrial pacing simply activate
ATRPACECTRL instead of VENTPACECTRL.
```

```
Pin Setting
```

```
PACECHARGECTRL LOW
PACEGNDCTRL HIGH
ATRPACECTRL LOW
ATRGNDCTRL LOW
ZATRCTRL LOW
ZVENTCTRL LOW
VENTGNDCTRL LOW
VENTPACECTRL HIGH
```

#### 3.3.3 Discharging Blocking Capacitor (may be combined with state 1)

After pacing occurs, the Blocking Capacitor is charged with the current that passed through the heart (state 2). The
Blocking Capacitor is discharged by grounding the ring of the recently paced chamber (state 2 paced the ventricle). The
Blocking Capacitor is used to balanced out the charge build-up that is caused by the pacing current. A net zero current
must be established in order to protect the patient.

Mandatory Pin Arrangement:

```
Note: Listed in proper chronological order. The order at which the pins are set is crucial for the safety of
the patient (always protect the patient from being directly connected to the PWM input charging signal).
```

```
This pin arrangement is an example of reducing thenet charge build-upto zero in the ventri-
cle. For atrial pacing simply activate ATRGNDCTRL instead of VENTGNDCTRL.
```

```
Pin Setting
```

```
PACEGNDCTRL HIGH
VENTPACECTRL LOW
ZATRCTRL LOW
ZVENTCTRL LOW
ATRPACECTRL LOW
ATRGNDCTRL LOW
VENTGNDCTRL HIGH
```

#### 3.3.4 PWM

In the context of capacitors, Pulse Width Modulation (PWM) is a helpful method to mimic analog signals with the use
of digital outputs. By toggling a digital signal at high frequency with variable duration it is possible to output an average
value of voltage ranging from digital HIGH and LOW.

For example, consider a PWM frequency of 1 kHz where the period is 1 ms and a HIGH voltage of 5V. If the Duty
Cycle (percentage of the period where the signal is HIGH) is set to 20% then the average voltage would be,
(0.2 \* 5V) = 1V

```
Figure 10: Example of PWM with resulting output average voltages
```

As shown inFigure 10the first PWM signal is outputting a low Duty Cycle, resulting in little output voltage to power
the light bulb. As Duty Cycles increase, the average voltage goes up and more power is transferred to the bulb. The same
functionality is used in the pacemaker to charge up capacitors used to pace the heart and set reference voltages since a
binary output is inadequate.

### 3.4 Strength-Duration Curve

In order to apply a proper pace the pacemaker must consider two factors; the voltage and the time length. The heart will
only fibrillate if it receives sufficient charge flow for a long enough time. The Strength-Duration Curve (SDC) displays the
necessary voltages required for a corresponding pulsing period. Any combination of voltage and duration that is located
below the curve will not be captured by the heart and will not properly pace either the ventricle or the atrium.

```
Figure 11: Strength-Duration Curve shows the relationship between voltage and pulse width [?]
```

The figure above displays this relationship and shows how small enough durations require unnecessarily high voltages
(stay away from this). Additionally, excessively long durations may require less voltage but may not be captured as well
due to their in sufficient current density.

### 3.5 Proper Pace Capture

A pacemaker is not only responsible for providing timely paces to the heart but also to keep track of which paces were
properly captured (a capture refers to the induced pacing of the heart due to an artificial stimuli). After artificial pacing
is performed it is the job of the on-board controller to confirm that the proper natural behaviour is detected as a response.
If the heart does not properly respond to the pulse it must record this incident and may be required to try again (with
adjusted pulse characteristics, if necessary).

Remember, the primary responsibility of the pacemaker is to ensure that proper pacing occurs! If an error occurs such as
non-captured stimulus it defeats the purpose of the pacemaker.

### 3.6 Desired Waveform

The figure below displays a visual of the ideal pacing waveform for a standard pacemaker. The Leading Edge Pulse is
caused by capacitor C22 (Pacing Capacitor) draining into the heart and C21, and the Recharge Pulse is due to C
(Blocking Capacitor) generating a current in the opposite direction to create a net zero charge (Section 4.3.2). The
waveform shown below is considered one pulse, the recharge pulse is not strong enough to generate another pulse.

```
Figure 12: Ideal Pacing Waveform [?]
```

For the purposes of our design we can leave the Recharge Pulse unrestricted, thus allowing all of the charge in C21 to
fully empty out back into the heart.

## 4 Pacemaker Impedance

This section will discuss the relevance of resistance and capacitance in the context of a pacemaker.

### 4.1 What is Impedance?

Impedance is an electrical measure of how the current flow is affected as it travels through the circuit. Impedance is a
combination of three elements; resistance, capacitance and inductance. But since inductant effects are negligible we will
disregard inductance in our circuitry and calculations.

In the context of biomedical devices, impedance is important when analyzing a device’s ability to transmit or receive
sufficient energy (in the form of electrical charge and current) to or from a specific area in the body. Remember Ohm’s
Law, higher impedances will result in lower current flow for the same voltage!

### 4.2 Resistance in Pacemaker

The main concern when analyzing resistance in pacemakers is two-fold; (1) the conductivity of electrodes, and (2) the
heart’s ability to ‘capture’ a pulse.

#### 4.2.1 Electrodes Conductivity

With electrodes, if the resistance is measured to be too high or too low then the patient and device may be at risk. The
metric for electrical conductivity of electrodes is known asLead Impedance.

Table 2: Implications and Causes of Undesired Electrode Impedances

```
Resistance Measured Resulting Current Implications Potential Causes
```

```
HIGH (>1000 Ω) Too Low - Insufficient power delivered to the heart
```

- Atrial / Ventricle won’t pace
  - Wire Factures
  - Disconnection from tissue

```
LOW (<300 Ω) Too High - may be harmful to the patient
```

- excessive current from the battery
- reduced battery life
  - Insulation Break
  - Wire shorts between leads

#### 4.2.2 Membrane Conductivity

In order to achieve the desired waveform (Section 3.6) it is required that the heart receives sufficient current. In order to
ensure that sufficient current one can reference the Strength-Duration Curve (SDC, Section 3.4) for pulse requirements.

As the leads are implanted (a foreign material to the body) and the heart continues to receives electrical pulses from
the pacemaker it tends to build a resistive, dense layer of fibrotic connective tissue. [?][?] This produces an additional,
non-conductive membrane surrounding the electrode, ultimately reducing conductivity in the chamber. To fight this
phenomena the pacemaker must increase the power of the pulse by raising the pulse amplitude. You can imagine this
graphically, as though the Threshold Curve in the SDC goes up.

In the case that the amplitude is too high or fibrotic tissue too dominant then the leads must be replaced with new
ones.

### 4.3 Capacitance in Pacemakers

The major role of capacitance in the context of pacemakers is the build-up of charge across the Ring-To-Tip Junction.

#### 4.3.1 Membrane Capacitance

Similar to membrane conductivity (Section 4.2.2) which addressed the idea of resistance in the human body, membrane
capacitance is also an important concept. Since our bodies are conductive (capable of hosting current), any two points
have a relative resistance and capacitance. So as a pulse is sent from the ring of the electrode, through the heart and into
the tip, it is crucial that current must also be sent in the opposite direction. This is done so that the junction remains
with a net zero charge in its natural capacitance.

The dangers of ignoring this concept are explained in Section 4.3.3.

#### 4.3.2 Net Zero Charge

As seen in the desired waveform (Section 3.6) a negative flow of current, caused by the blocking capacitor is mandatory.
This is due to the charge build-up cause by sending current from the ring to the tip. To eliminate this build-up a current
is sent from the tip to the ring which is equal in power and duration, thus a net charge of zero. [?]

#### 4.3.3 Potential Risk of Charge Build-up

If this charge build-up is not accounted for then a voltage will begin to collect in the ring-to-tip junction. This can cause
a couple of potential issues, the first placing the patient at risk of spontaneously pacing and the second is increasing the
amplitude of a pulse unknowingly (this occurs by adding the voltages of the pulse amplitude and the charge build-up).

### 4.4 DCM to Pacemaker Communication via Inductance

The major consideration for inductance and magnetism is with the communication from the DCM to the pacemaker. In
traditional pacemakers a coil is placed in the pacemaker so that information can travel through the skin via magnetic
conduction. A magnet will be placed on the surface of the skin that will transmit the DCM message using magnetic waves.
The coil in the pacemaker will collect this information using the coil and execute the DCM instructions. [?]

In the context of the course this method of telemetry is not important since we use hardwired serial communication
wit the board.

## 5 Hysteresis Pacing

This section will explain the concept of Hysteresis in the context of pacing rate in the pacemaker, as well as provide
examples of this functionality.

### 5.1 What is Hysteresis Pacing

In the event that the heart is still capable of some functionality it may be desirable to allow the patient’s heart to naturally
pace whenever possible. As a result,hysteresis pacingis a method used control the pacing rate while still monitoring
to see if the heart will pace on its own. It does so by pacing at longer periods than determined by the LRL and monitors
the pacing in either (or both) chambers.

Note:Hysteresis functionality is patient-specific and may not be necessary in every case!

### 5.2 Example of Implementation

If hysteresis pacing is notemployed then the pacemaker will not allow the heart to pace at any rate lower than the LRL
(labeled as BRL inFigure 13). In this scenario depicted inFigure 13, the heart may never naturally pace since the
automatic interval is the same as the escape interval and the pacemaker will almost always pace before the heart.

```
Figure 13: Regular Pacing without Hysteresis [?]
```

If hysteresis pacing is implemented (as shown inFigure 14) then the escape interval (ESCR) is longer than the automatic
LRL interval (BRL inFigure 14). As a result, the ESCR can be tuned to allow enough time to see if the heart will
pace naturally. If sufficient time has been allotted (ie. the ESCR interval has expired) then the pacemaker can be more
confident that the artificial pace is necessary. If the heart paces naturally prior to the expiration of the ESCR then the
artificial pace is inhibited.

```
Figure 14: Implemented Hysteresis Pacing [?]
```
